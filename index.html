<link rel="stylesheet" href="static/css/index.css">
<!-- ✂️ 作者信息置顶并美化 -->
<div id="profile" class="card-info-avatar is-center">
  <img class="avatar-img" src="https://avatars.githubusercontent.com/u/9919?s=200&v=4" alt="avatar">
  <div class="author-info__name">Jinglong</div>
  <div class="author-info__description">学无止境</div>
</div>

<!-- ✂️ 登录模块 -->
<hr>
<h2>登录</h2>
<div id="login-container" class="tool">
  <input type="password" id="password-input" placeholder="输入密码...">
  <button onclick="login()">登录</button>
  <div id="login-status"></div>
</div>

<!-- ✂️ 待办事项模块插入位置 -->
<hr>
<h2>待办事项</h2>
<div id="todo-container" class="tool">
  <input type="text" id="todo-input" placeholder="输入待办事项..." disabled>
  <button onclick="addTodo()" disabled>添加</button>
  <ul id="todo-list"></ul>
</div>

<!-- ✂️ 日程表模块 -->
<hr>
<h2>本周日程表</h2>
<div id="schedule-table">
  <table>
    <thead>
      <tr>
        <th>时间</th>
        <th>周一</th>
        <th>周二</th>
        <th>周三</th>
        <th>周四</th>
        <th>周五</th>
        <th>周六</th>
        <th>周日</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>9:00 - 10:00</td>
        <td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td>
      </tr>
      <tr>
        <td>10:00 - 11:00</td>
        <td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td>
      </tr>
      <tr>
        <td>11:00 - 12:00</td>
        <td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td>
      </tr>
      <tr>
        <td>12:00 - 13:00</td>
        <td>2541W_LEC(12:45~14:05)</td><td>X</td><td>2541W_LEC(12:45~14:05)</td><td>X</td><td>X</td><td>X</td><td>X</td>
      </tr>
      <tr>
        <td>13:00 - 14:00</td>
        <td>2541W_LEC(12:45~14:05)</td><td>X</td><td>2541W_LEC(12:45~14:05)</td><td>X</td><td>X</td><td>X</td><td>X</td>
      </tr>
      <tr>
        <td>14:00 - 15:00</td>
        <td>2541W_LEC(12:45~14:05)</td><td>X</td><td>2541W_LEC(12:45~14:05)</td><td>X</td><td>X</td><td>X</td><td>X</td>
      </tr>
      <tr>
        <td>15:00 - 16:00</td>
        <td>X</td><td>X</td><td>2541W_LAB(14:15~15:35)</td><td>X</td><td>X</td><td>X</td><td>X</td>
      </tr>
      <tr>
        <td>16:00 - 17:00</td>
        <td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td>
      </tr>
      <tr>
        <td>17:00 - 18:00</td>
        <td>X</td><td>Office Hours</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td>
      </tr>
      <tr>
        <td>18:00 - 19:00</td>
        <td>X</td><td>Office Hours</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td>
      </tr>
      <tr>
        <td>19:00 - 00:00</td>
        <td colspan="7">自由时间</td>
      </tr>
      <!-- 可继续添加行 -->
    </tbody>
  </table>
</div>

<script>
  let isLoggedIn = false;

  function login() {
    const password = document.getElementById('password-input').value;
    const loginStatus = document.getElementById('login-status');
    if (password === 'djl20000828') { // 设置一个简单的密码
      isLoggedIn = true;
      loginStatus.textContent = '登录成功！';
      loginStatus.style.color = 'green';
      document.getElementById('todo-input').disabled = false;
      document.querySelector('#todo-container button').disabled = false;
    } else {
      loginStatus.textContent = '密码错误，请重试。';
      loginStatus.style.color = 'red';
    }
  }

  function addTodo() {
    if (!isLoggedIn) {
      alert('请先登录！');
      return;
    }
    const input = document.getElementById('todo-input');
    const text = input.value.trim();
    if (!text) return;
    const li = document.createElement('li');
    li.textContent = text;
    li.onclick = () => li.classList.toggle('completed');

    const del = document.createElement('span');
    del.textContent = '✖';
    del.onclick = (e) => {
      e.stopPropagation();
      li.remove();
      saveTodos(); // 保存更新后的待办事项
    };
    li.appendChild(del);

    document.getElementById('todo-list').appendChild(li);
    input.value = '';
    saveTodos(); // 保存待办事项
  }

  function saveTodos() {
    const todos = [];
    document.querySelectorAll('#todo-list li').forEach((li) => {
      todos.push({
        text: li.firstChild.textContent,
        completed: li.classList.contains('completed'),
      });
    });
    localStorage.setItem('todos', JSON.stringify(todos));
  }

  function loadTodos() {
    const todos = JSON.parse(localStorage.getItem('todos')) || [];
    const todoList = document.getElementById('todo-list');
    todoList.innerHTML = ''; // 清空列表
    todos.forEach((todo) => {
      const li = document.createElement('li');
      li.textContent = todo.text;
      if (todo.completed) li.classList.add('completed');
      li.onclick = () => li.classList.toggle('completed');

      const del = document.createElement('span');
      del.textContent = '✖';
      del.onclick = (e) => {
        e.stopPropagation();
        li.remove();
        saveTodos(); // 保存更新后的待办事项
      };
      li.appendChild(del);

      todoList.appendChild(li);
    });
  }

  function colorizeTable() {
    const table = document.querySelector('#schedule-table table');
    const cells = table.querySelectorAll('td');
    const colorMap = {}; // 用于存储内容和对应颜色的映射
    const colors = ['#FFCCCC', '#CCFFCC', '#CCCCFF', '#FFFFCC', '#CCFFFF', '#FFCCFF']; // 预定义颜色
    let colorIndex = 0;

    cells.forEach((cell) => {
      const text = cell.textContent.trim();
      if (!text || text === 'X') {
        // 没有内容或内容为 "X" 的单元格保持白色
        cell.style.backgroundColor = '#FFFFFF';
        return;
      }

      if (!colorMap[text]) {
        // 如果内容没有对应颜色，分配一个新颜色
        colorMap[text] = colors[colorIndex];
        colorIndex = (colorIndex + 1) % colors.length; // 循环使用颜色
      }

      // 设置单元格背景颜色
      cell.style.backgroundColor = colorMap[text];
    });
  }

  // 在页面加载时自动调用
  window.onload = () => {
    loadTodos(); // 加载待办事项
    colorizeTable(); // 为表格着色
  };
</script>